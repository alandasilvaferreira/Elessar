!function(n){return typeof exports=="object"?module.exports=n(require("jquery")):typeof define=="function"&&define.amd?define(["jquery"],n):window.RangeBar=n(window.jQuery)}(function(n){return function t(n,i,r){function u(f,o){var h,s;if(!i[f]){if(!n[f]){if(h=typeof require=="function"&&require,!o&&h)return h(f,!0);if(e)return e(f,!0);throw new Error("Cannot find module '"+f+"'");}s=i[f]={exports:{}};n[f][0].call(s.exports,function(t){var i=n[f][1][t];return u(i?i:t)},s,s.exports,t,n,i,r)}return i[f].exports}for(var e=typeof require=="function"&&require,f=0;f<r.length;f++)u(r[f]);return u}({1:[function(t,i){var r=t("estira"),u=t("./raf"),e=Object.prototype.hasOwnProperty,f=r.extend({initialize:function(t){this.$el=n(t);this.$data={};this.$el.data("element",this)},draw:function(n){var t=this;return this.drawing?this.$el:(u(function(){t.drawing=!1;t.$el.css(n)}),this.drawing=!0,this.$el)},on:function(){return this.$el.on.apply(this.$el,arguments),this},one:function(){return this.$el.one.apply(this.$el,arguments),this},off:function(){return this.$el.off.apply(this.$el,arguments),this},trigger:function(){return this.$el.trigger.apply(this.$el,arguments),this},remove:function(){this.$el.remove()},detach:function(){this.$el.detach()},data:function(t,i){var r=t;if(typeof t=="string"){if(typeof i=="undefined")return this.$data[t];r={};r[t]=i}return n.extend(this.$data,r),this}});i.exports=f},{"./raf":6,estira:10}],2:[function(n,t){var i=Object.prototype.hasOwnProperty;t.exports=function(n,t){return i.call(t,n)?t[n]:t.originalEvent&&t.originalEvent.touches?t.originalEvent.touches[0][n]:0}},{}],3:[function(n,t){var i=n("./element"),r=n("./vertical"),u=i.extend(r).extend({initialize:function f(n){f.super$.call(this,'<div class="elessar-indicator">');n.indicatorClass&&this.$el.addClass(n.indicatorClass);n.value&&this.val(n.value);this.options=n},val:function(n){return n&&(this.isVertical()?this.draw({top:100*n+"%"}):this.draw({left:100*n+"%"}),this.value=n),this.value}});t.exports=u},{"./element":1,"./vertical":9}],4:[function(n,t){var i=n("./element.js"),r=i.extend({initialize:function u(n){u.super$.call(this,'<div class="elessar-label">');this.$el.css(n.perant.edge("start"),n.value*100+"%");typeof n.label=="function"?this.$el.text(n.label.call(this,n.perant.normalise(n.value))):typeof n.label=="string"?this.$el.text(n.label):this.$el.text(n.perant.normalise(n.value))}});t.exports=r},{"./element.js":1}],5:[function(t,i){var r=t("./range"),u=t("./raf"),f=r.extend({initialize:function e(t){e.super$.call(this,n.extend({readonly:!0,label:"+"},t));this.$el.addClass("elessar-phantom");this.on("mousedown.elessar touchstart.elessar",n.proxy(this.mousedown,this))},mousedown:function(n){if(n.which===1){var i=n.pageX,t=this.options.perant.addRange(this.val());this.remove();this.options.perant.trigger("addrange",[t.val(),t]);u(function(){t.$el.find(".elessar-handle:first-child").trigger(n.type)})}},removePhantom:function(){}});i.exports=f},{"./raf":6,"./range":7}],6:[function(n,t){for(var u=0,f=["webkit","moz"],i=window.requestAnimationFrame,r=0;r<f.length&&!window.requestAnimationFrame;++r)i=window[f[r]+"RequestAnimationFrame"];i||(i=function(n){var t=(new Date).getTime(),i=Math.max(0,16-(t-u)),r=window.setTimeout(function(){n(t+i)},i);return u=t+i,r});t.exports=i},{}],7:[function(t,i){var u=t("./element"),r=t("./eventprop"),f=t("./vertical"),e=u.extend(f).extend({initialize:function o(t){var i=this;if(o.super$.call(this,'<div class="elessar-range"><span class="elessar-barlabel">'),this.options=t,this.perant=t.perant,this.options.rangeClass&&this.$el.addClass(this.options.rangeClass),this.readonly())this.$el.addClass("elessar-readonly");else{this.$el.prepend('<div class="elessar-handle">').append('<div class="elessar-handle">');this.on("mouseenter.elessar touchstart.elessar",n.proxy(this.removePhantom,this));this.on("mousedown.elessar touchstart.elessar",n.proxy(this.mousedown,this));this.on("click",n.proxy(this.click,this))}if(typeof this.options.label=="function")this.on("changing",function(t,r){var u=Object.assign({},r);u=Object.assign({start:n.proxy(i.perant.normalise,i.perant)(r.start),end:n.proxy(i.perant.normalise,i.perant)(r.end)},u);i.writeLabel(i.options.label.call(i,u))});else this.writeLabel(this.options.label);this.range={start:0,end:0,max:Infinity,css:"",extended:null};this.hasChanged=!1;this.options.value&&this.val(this.options.value)},writeLabel:function(n){this.$el.find(".elessar-barlabel")[this.options.htmlLabel?"html":"text"](n)},isVertical:function(){return this.perant.options.vertical},removePhantom:function(){this.perant.removePhantom()},readonly:function(){return typeof this.options.readonly=="function"?this.options.readonly.call(this.perant,this):this.options.readonly},val:function(t,i){function h(n){return Math.round(n/c.options.snap)*c.options.snap}var u,o,s;if(typeof t=="undefined")return this.range;i=n.extend({},{dontApplyDelta:!1,trigger:!0},i||{});var f=this.perant.nextRange(this.$el),e=this.perant.prevRange(this.$el),r=t.end-t.start,c=this;return(this.options.snap&&(t.start=h(t.start),t.end=h(t.end),r=h(r)),f&&f.val().start<=t.end&&e&&e.val().end>=t.start&&(t.end=f.val().start,t.start=e.val().end),f&&f.val().start<t.end&&(!this.perant.options.allowSwap||f.val().end>=t.start?(t.end=f.val().start,i.dontApplyDelta||(t.start=t.end-r)):this.perant.repositionRange(this,t)),e&&e.val().end>t.start&&(!this.perant.options.allowSwap||e.val().start<=t.end?(t.start=e.val().end,i.dontApplyDelta||(t.end=t.start+r)):this.perant.repositionRange(this,t)),t.end>=1&&(t.end=1,i.dontApplyDelta||(t.start=1-r)),t.start<=0&&(t.start=0,i.dontApplyDelta||(t.end=r)),this.perant.options.bound&&(u=this.perant.options.bound(this),u&&(u.upper&&t.end>this.perant.abnormalise(u.upper)&&(t.end=this.perant.abnormalise(u.upper),i.dontApplyDelta||(t.start=t.end-r)),u.lower&&t.start<this.perant.abnormalise(u.lower)&&(t.start=this.perant.abnormalise(u.lower),i.dontApplyDelta||(t.end=t.start+r)))),this.range.start===t.start&&this.range.end===t.end)?this.$el:(this.range=t,i.trigger&&(this.$el.triggerHandler("changing",[t,this.$el]),this.hasChanged=!0),o=100*t.start+"%",s=100*(t.end-t.start)+"%",this.draw(this.perant.options.vertical?{top:o,minHeight:s}:{left:o,minWidth:s}),this)},click:function(n){n.stopPropagation();n.preventDefault();var t=this;n.which===2&&this.perant.options.allowDelete&&(this.deleteConfirm?(this.perant.removeRange(this),clearTimeout(this.deleteTimeout)):(this.$el.addClass("elessar-delete-confirm"),this.deleteConfirm=!0,this.deleteTimeout=setTimeout(function(){t.$el.removeClass("elessar-delete-confirm");t.deleteConfirm=!1},this.perant.options.deleteTimeout)))},mousedown:function(t){if(t.stopPropagation(),t.preventDefault(),this.hasChanged=!1,!(t.which>1)){if(n(t.target).is(".elessar-handle:first-child")){n("body").addClass("elessar-resizing").toggleClass("elessar-resizing-vertical",this.isVertical());n(document).on("mousemove.elessar touchmove.elessar",this.resizeStart(t))}else if(n(t.target).is(".elessar-handle:last-child")){n("body").addClass("elessar-resizing").toggleClass("elessar-resizing-vertical",this.isVertical());n(document).on("mousemove.elessar touchmove.elessar",this.resizeEnd(t))}else{n("body").addClass("elessar-dragging").toggleClass("elessar-dragging-vertical",this.isVertical());n(document).on("mousemove.elessar touchmove.elessar",this.drag(t))}var i=this;n(document).one("mouseup.elessar touchend.elessar",function(t){t.stopPropagation();t.preventDefault();i.hasChanged&&!i.swapping&&i.trigger("change",[i.range,i.$el]);i.swapping=!1;n(document).off("mouseup.elessar mousemove.elessar touchend.elessar touchmove.elessar");n("body").removeClass("elessar-resizing elessar-dragging elessar-resizing-vertical elessar-dragging-vertical")})}},drag:function(n){var t=this,u=this.startProp("offset"),f=this.startProp("position"),i=r(this.ifVertical("clientY","clientX"),n);return mouseOffset=i?i-u:0,beginSize=this.totalSize(),perant=this.options.perant,perantStart=perant.startProp("offset"),perantSize=perant.totalSize(),function(n){var u,i,e,f;n.stopPropagation();n.preventDefault();u=r(t.ifVertical("clientY","clientX"),n);u&&(i=u-perantStart-mouseOffset,i>=0&&i<=perantSize-beginSize?(e=i/perantSize-t.range.start,f=Object.assign({},t.range),f=Object.assign({start:i/perantSize,end:t.range.end+e},f),t.val(f)):mouseOffset=u-t.startProp("offset"))}},resizeEnd:function(t){var i=this,f=this.startProp("offset"),e=this.startProp("position"),o=r(this.ifVertical("clientY","clientX"),t),c=o?o-f:0,l=this.totalSize(),s=this.options.perant,a=s.startProp("offset"),u=s.totalSize(),h=this.options.minSize*u;return function(t){var l=t.type==="touchmove"?"touchend":"mouseup",a=t.type==="touchmove"?"touchstart":"mousedown",c,o,s;t.stopPropagation();t.preventDefault();c=r(i.ifVertical("clientY","clientX"),t);o=c-f;c&&(o>u-e&&(o=u-e),o>=h?(s=Object.assign({},i.range),s=Object.assign({end:i.range.start+o/u},s),i.val(s,{dontApplyDelta:!0})):o<=10&&(i.swapping=!0,n(document).trigger(l+".elessar"),i.$el.find(".elessar-handle:first-child").trigger(a+".elessar")))}},resizeStart:function(t){var i=this,h=this.startProp("offset"),u=this.startProp("position"),f=r(this.ifVertical("clientY","clientX"),t),c=f?f-h:0,e=this.totalSize(),o=this.options.perant,l=o.startProp("offset"),s=o.totalSize(),a=this.options.minSize*s;return function(t){var y=t.type==="touchmove"?"touchend":"mouseup",p=t.type==="touchmove"?"touchstart":"mousedown",o;t.stopPropagation();t.preventDefault();var v=r(i.ifVertical("clientY","clientX"),t),f=v-l-c,h=u+e-f;v&&(f<0&&(f=0,h=u+e),h>=a?(o=Object.assign({},i.range),o=Object.assign({start:f/s},o),i.val(o,{dontApplyDelta:!0})):h<=10&&(i.swapping=!0,n(document).trigger(y+".elessar"),i.$el.find(".elessar-handle:last-child").trigger(p+".elessar")))}}});i.exports=e},{"./element":1,"./eventprop":2,"./vertical":9}],8:[function(t,i){var o=t("./element"),u=t("./range"),f=t("./phantom"),s=t("./indicator"),h=t("./eventprop"),c=t("./vertical"),e=t("./mark.js"),r=o.extend(c).extend({initialize:function l(t){var i,f,u;t=t||{};l.super$.call(this,'<div class="elessar-rangebar">');this.options=n.extend({},r.defaults,t);this.options.min=this.options.valueParse(this.options.min);this.options.max=this.options.valueParse(this.options.max);this.options.barClass&&this.$el.addClass(this.options.barClass);this.options.vertical&&this.$el.addClass("elessar-vertical");this.ranges=[];this.on("mousemove.elessar touchmove.elessar",n.proxy(this.mousemove,this));this.on("mouseleave.elessar touchleave.elessar",n.proxy(this.removePhantom,this));if(t.values&&this.setVal(t.values),t.bgLabels&&(t.bgMark={count:t.bgLabels}),t.bgMark)if(this.$markContainer=n('<div class="elessar-labels">').appendTo(this.$el),t.bgMark.count)for(i=0;i<t.bgMark.count;++i)this.$markContainer.append(new e({label:t.bgMark.label,value:i/t.bgMark.count,perant:this}).$el);else if(t.bgMark.interval)for(i=this.abnormalise(this.options.min);i<this.abnormalise(this.options.max);i+=this.abnormalise(t.bgMark.interval))this.$markContainer.append(new e({label:t.bgMark.label,value:i,perant:this}).$el);f=this;t.indicator&&(u=this.indicator=new s({perant:this,vertical:this.options.vertical,indicatorClass:t.indicatorClass}),u.val(this.abnormalise(t.indicator(this,u,function(){u.val(f.abnormalise(t.indicator(f,u)))}))),this.$el.append(u.$el))},normaliseRaw:function(n){return this.options.min+n*(this.options.max-this.options.min)},normalise:function(n){return this.options.valueFormat(this.normaliseRaw(n))},abnormaliseRaw:function(n){return(n-this.options.min)/(this.options.max-this.options.min)},abnormalise:function(n){return this.abnormaliseRaw(this.options.valueParse(n))},findGap:function(n){var t=0;return this.ranges.forEach(function(i,r){i.val().start<n.start&&i.val().end<n.end&&(t=r+1)}),t},insertRangeIndex:function(n,t,i){i||this.ranges.splice(t,0,n);this.ranges[t-1]?this.ranges[t-1].$el.after(n.$el):this.$el.prepend(n.$el)},addRange:function(n,t){var i=u({perant:this,snap:this.options.snap?this.abnormaliseRaw(this.options.snap+this.options.min):null,label:this.options.label,rangeClass:this.options.rangeClass,minSize:this.options.minSize?this.abnormaliseRaw(this.options.minSize+this.options.min):null,readonly:this.options.readonly,htmlLabel:this.options.htmlLabel}),r;this.options.data&&i.data(this.options.data.call(i,this));t&&i.data(t);this.insertRangeIndex(i,this.findGap(n));i.val(n);r=this;i.on("changing",function(n,t,i){n.stopPropagation();r.trigger("changing",[r.val(),i])}).on("change",function(n,t,i){n.stopPropagation();r.trigger("change",[r.val(),i])});return i},prevRange:function(n){var t=n.index();if(t>=0)return this.ranges[t-1]},nextRange:function(n){var t=n.index();if(t>=0)return this.ranges[n instanceof f?t:t+1]},setVal:function(t){var u,r,i;if(this.ranges.length>t.length){for(u=t.length-1,r=this.ranges.length-1;u<r;--r)this.removeRange(r);this.ranges.length=t.length}return i=this,t.forEach(function(t,r){i.ranges[r]?(t.start=n.proxy(i.abnormalise,i)(t.start),t.end=n.proxy(i.abnormalise,i)(t.end),i.ranges[r].val(t)):(t.start=n.proxy(i.abnormalise,i)(t.start),t.end=n.proxy(i.abnormalise,i)(t.end),i.addRange(t))}),this},val:function(t){var i=this;return typeof t=="undefined"?this.ranges.map(function(t){return t.val().start=n.proxy(i.normalise,i)(t.start),t.val().end=n.proxy(i.normalise,i)(t.end),t.val()}):(this.readonly()||this.setVal(t),this)},removePhantom:function(){this.phantom&&(this.phantom.remove(),this.phantom=null)},removeRange:function(n,t,i){n instanceof u&&(n=this.ranges.indexOf(n));this.ranges.splice(n,1)[0][i?"detach":"remove"]();t||this.trigger("change",[this.val()])},repositionRange:function(n,t){this.removeRange(n,!0,!0);this.insertRangeIndex(n,this.findGap(t))},calcGap:function(n){var t=this.ranges[n-1]?this.ranges[n-1].val().end:0,i=this.ranges[n]?this.ranges[n].val().start:1;return this.normaliseRaw(i)-this.normaliseRaw(t)},readonly:function(){return typeof this.options.readonly=="function"?this.options.readonly.call(this):this.options.readonly},mousemove:function(t){var r=this.options.minSize?this.abnormaliseRaw(this.options.minSize+this.options.min):.05,o=h(this.ifVertical("pageY","pageX"),t),i=(o-this.startProp("offset"))/this.totalSize()-r/2,s=t.target===t.currentTarget,c=n(t.target).is(".elessar-phantom"),u,e;if((s||c)&&this.ranges.length<this.options.maxRanges&&!n("body").is(".elessar-dragging, .elessar-resizing")&&!this.readonly()){this.phantom||(this.phantom=f({perant:this,snap:this.options.snap?this.abnormaliseRaw(this.options.snap+this.options.min):null,label:"+",minSize:this.options.minSize?this.abnormaliseRaw(this.options.minSize+this.options.min):null,rangeClass:this.options.rangeClass}));u=this.findGap({start:i,end:i+r});e=this;this.one("addrange",function(n,t,i){i.one("mouseup",function(){e.trigger("change",[e.val(),i])})});(!this.options.minSize||this.calcGap(u)>=this.options.minSize)&&(this.insertRangeIndex(this.phantom,u,!0),this.phantom.val({start:i,end:i+r},{trigger:!1}))}}});r.defaults={min:0,max:100,valueFormat:function(n){return n},valueParse:function(n){return n},maxRanges:Infinity,readonly:!1,bgLabels:0,deleteTimeout:5e3,allowDelete:!1,vertical:!1,htmlLabel:!1,allowSwap:!0};i.exports=r},{"./element":1,"./eventprop":2,"./indicator":3,"./mark.js":4,"./phantom":5,"./range":7,"./vertical":9}],9:[function(n,t){t.exports={isVertical:function(){return this.options.vertical},ifVertical:function(n,t){return this.isVertical()?n:t},edge:function(n){if(n==="start")return this.ifVertical("top","left");if(n==="end")return this.ifVertical("bottom","right");throw new TypeError("What kind of an edge is "+n);},totalSize:function(){return this.$el[this.ifVertical("height","width")]()},edgeProp:function(n,t){var i=this.$el[t]();return i[this.edge(n)]},startProp:function(n){return this.edgeProp("start",n)},endProp:function(n){return this.edgeProp("end",n)}}},{}],10:[function(n,t,i){(function(){function n(n,t){var r={}.hasOwnProperty;for(var i in t)r.call(t,i)&&(n[i]=t[i]);return n}function r(n,t){function i(){}return i.prototype=(n.superclass=t).prototype,(n.prototype=new i).constructor=n,typeof t.extended=="function"&&t.extended(n),n}(function(n){switch(!1){case!(typeof define=="function"&&define.amd!=null):return define([],n);case typeof i!="object":return t.exports=n();default:return this.Base=n()}})(function(){return function(){function t(){}t.displayName="Base";var i,u=t.prototype,f=t;return i=function(t,i,r,u,f){return t[i]=typeof r=="function"?n(function(){var n=this;return r.superclass$=f,r.super$=function(){return u.apply(n,arguments)},r.apply(this,arguments)},r):r},t.extend=function(u,f){return f==null&&(f=u),function(e){function h(){var n=this instanceof c?this:new c;return n.initialize.apply(n,arguments),n}function c(){}var o,l,a,s=r(n(h,e),e).prototype;n(h,t);typeof u=="string"&&(h.displayName=u);c.prototype=s;s.initialize=function(){return e.prototype.initialize!=null?e.prototype.initialize.apply(this,arguments):e.apply(this,arguments)};for(o in l=f)a=l[o],i(s,o,a,s[o],e);return h}(this)},t.meta=function(n){var t,r;for(t in n)r=n[t],i(this,t,r,this[t],this);return this},u.initialize=function(){},t}()})}).call(this)},{}]},{},[8])(8)});